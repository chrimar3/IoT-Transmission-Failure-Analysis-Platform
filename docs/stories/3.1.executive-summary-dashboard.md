# Story 3.1: Executive Summary Dashboard

## Status
**Draft**

## Story
**As a** building manager,  
**I want** an executive summary dashboard,  
**so that** I can quickly assess overall building performance and identify critical issues.

## Acceptance Criteria
1. Key Performance Indicators (KPIs) displayed prominently
2. Building health score with clear visual indicators
3. Current alerts and notifications summary
4. Quick access to most critical issues
5. Responsive design for mobile executives
6. Real-time data updates every 5 minutes

## Priority & Effort
**Priority**: P0 (Product Critical)  
**Effort**: 5 points  
**Epic**: Epic 3 - Core Analytics Dashboard

## Tasks / Subtasks
- [ ] Task 1: Design executive summary layout with UX best practices (AC: 1, 5)
  - [ ] Create responsive grid layout for KPI cards
  - [ ] Design mobile-first approach with collapsible sections
  - [ ] Implement consistent spacing and typography
- [ ] Task 2: Implement KPI calculation algorithms (AC: 1)
  - [ ] Calculate energy efficiency metrics from sensor data
  - [ ] Compute equipment utilization rates
  - [ ] Generate performance trend indicators
- [ ] Task 3: Create building health scoring system (AC: 2)
  - [ ] Define health scoring algorithm based on sensor readings
  - [ ] Implement visual health score widget with color coding
  - [ ] Add health score breakdown by floor/equipment type
- [ ] Task 4: Add alert prioritization and display (AC: 3, 4)
  - [ ] Implement alert severity classification (Critical, Warning, Info)
  - [ ] Create alerts summary component with quick actions
  - [ ] Add navigation to detailed alert views
- [ ] Task 5: Implement auto-refresh functionality (AC: 6)
  - [ ] Set up 5-minute polling interval for data updates
  - [ ] Add loading states for refresh cycles
  - [ ] Implement error handling for failed updates
- [ ] Task 6: Add mobile-responsive design (AC: 5)
  - [ ] Test layout on mobile devices (320px-768px)
  - [ ] Implement touch-friendly interactions
  - [ ] Optimize performance for mobile networks

## Dev Notes

### Previous Story Insights
No previous story context available - this is the first frontend story in Epic 3.

### Frontend Architecture Requirements
**Framework**: Next.js 14+ with App Router for file-based routing [Source: architecture/tech-stack.md]  
**Language**: TypeScript 5.8.3+ with strict type checking [Source: architecture/tech-stack.md]  
**UI Components**: Tailwind CSS + Shadcn/ui component library [Source: architecture/tech-stack.md]  
**Charting**: Chart.js or D3.js for interactive KPI visualizations [Source: architecture/tech-stack.md]  
**State Management**: React built-in state + Context API for dashboard data [Source: architecture/tech-stack.md]

### Data Models & API Integration
**Analytics Endpoint**: `GET /api/readings/summary` for dashboard overview data [Source: architecture/8-api-architecture.md]  
**Time-series Data**: `GET /api/readings/timeseries` for trend calculations [Source: architecture/8-api-architecture.md]  
**Database Schema**: Access to `sensor_readings` table and `daily_aggregates` materialized view [Source: architecture/7-database-schema-bangkok-dataset-optimized.md]  
**Rate Limiting**: Free tier limited to 100 requests/hour [Source: architecture/8-api-architecture.md]

### Component Architecture & File Locations
**Dashboard Page**: `/src/app/dashboard/page.tsx` - main dashboard route [Source: architecture/source-tree.md]  
**Analytics Components**: `/src/components/features/analytics/` directory structure [Source: architecture/source-tree.md]  
- `ExecutiveDashboard.tsx` - main dashboard container
- `KPICard.tsx` - individual KPI display components  
- `HealthScoreWidget.tsx` - building health visualization
- `AlertsSummary.tsx` - alerts and notifications panel
**Custom Hooks**: `/src/hooks/useAnalytics.ts` for analytics data management [Source: architecture/source-tree.md]  
**API Routes**: `/src/app/api/analytics/summary/route.ts` for data endpoints [Source: architecture/source-tree.md]

### Component Development Standards
**TypeScript Patterns**: Strict interface definitions with `IComponentProps` naming [Source: architecture/coding-standards.md]  
**Component Structure**: Hooks first, event handlers, early returns, main render pattern [Source: architecture/coding-standards.md]  
**Error Boundaries**: Implement ErrorBoundary components for dashboard resilience [Source: architecture/coding-standards.md]  
**Performance**: Use React.memo, useMemo, useCallback for optimization [Source: architecture/coding-standards.md]

### Production Readiness Requirements

**API Failure Handling**: Implement retry logic with exponential backoff (3 attempts) for data fetching [Source: architecture/8-api-architecture.md]  
**Service Resilience**: Graceful degradation when Supabase is unavailable - show cached data [Source: architecture/8-api-architecture.md]  
**Rate Limit Monitoring**: Handle 100 requests/hour limit with user notifications [Source: architecture/8-api-architecture.md]  
**Error Logging**: Console error logging with context for debugging [Source: architecture/coding-standards.md]  
**Performance Targets**: Page load <2 seconds, API response <500ms average [Source: architecture/tech-stack.md]

### Testing Standards
**Test Coverage**: 85% minimum coverage, 100% for business logic components [Source: architecture/coding-standards.md]  
**Test Files**: Co-located with components using `ComponentName.test.tsx` pattern [Source: architecture/source-tree.md]  
**Testing Framework**: Jest + React Testing Library for component testing [Source: architecture/tech-stack.md]  
**Test Structure**: Arrange-Act-Assert pattern with proper mocking [Source: architecture/coding-standards.md]

### Technical Constraints
**Bundle Size**: <500KB initial JavaScript bundle requirement [Source: architecture/coding-standards.md]  
**Code Splitting**: Dynamic imports for non-critical dashboard components [Source: architecture/coding-standards.md]  
**Mobile Performance**: Optimized for mobile networks and touch interactions [Source: architecture/coding-standards.md]  
**Security**: Input validation with Zod schemas, secure session management [Source: architecture/coding-standards.md]

## Change Log
| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2025-09-11 | 1.0 | Initial story creation with comprehensive technical context | Story Creation Agent |

## Dev Agent Record
*This section will be populated by the development agent during implementation*

### Agent Model Used
*To be filled during development*

### Debug Log References  
*To be filled during development*

### Completion Notes List
*To be filled during development*

### File List
*To be filled during development*

## QA Results
*Results from QA Agent review will be added here after implementation*